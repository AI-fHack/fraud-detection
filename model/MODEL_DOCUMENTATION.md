# üìã –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –º–æ–¥–µ–ª–∏ Fraud Detection

## –ú–æ–¥–µ–ª—å
- **–¢–∏–ø:** LightGBM
- **–í–µ—Ä—Å–∏—è:** 1.0
- **–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2025-11-24 09:25:20

## –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
- **F2-score:** 0.6358
- **Recall:** 0.6667
- **Precision:** 0.5366
- **F1-score:** 0.5946
- **ROC-AUC:** 0.9788

## –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
- **Threshold:** 0.550

## –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (Input)
–ú–æ–¥–µ–ª—å –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –Ω–∞ –≤—Ö–æ–¥ DataFrame —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ (82 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤):

- time_until_next_tx
- user_tx_count_total
- user_min_amount_total
- time_since_last_tx
- amount
- user_id
- day_of_month
- user_max_amount_total
- month_cos
- amount_zscore_user
- amount_diff_from_user_avg
- amount_ratio_to_user_avg
- user_avg_amount_total
- month_sin
- hour_sin
- user_std_amount_total
- day_of_week
- hour
- tx_mean_amount_1h
- month
... –∏ –µ—â–µ 62 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤

**–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:**
- –í—Å–µ –ø—Ä–∏–∑–Ω–∞–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å —á–∏—Å–ª–æ–≤—ã–º–∏
- –ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –∑–∞–ø–æ–ª–Ω–µ–Ω—ã (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è 0)
- –ü—Ä–∏–∑–Ω–∞–∫–∏ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ —Ç–æ–º –∂–µ –ø–æ—Ä—è–¥–∫–µ, —á—Ç–æ –∏ –≤ —Å–ø–∏—Å–∫–µ selected_features

## –í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (Output)
–ú–æ–¥–µ–ª—å –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç:
1. **–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞** (float): –∑–Ω–∞—á–µ–Ω–∏–µ –æ—Ç 0 –¥–æ 1
   - –ë–ª–∏–∑–∫–æ –∫ 0: –Ω–∏–∑–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞
   - –ë–ª–∏–∑–∫–æ –∫ 1: –≤—ã—Å–æ–∫–∞—è –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –º–æ—à–µ–Ω–Ω–∏—á–µ—Å—Ç–≤–∞

2. **–ö–ª–∞—Å—Å** (int): 0 –∏–ª–∏ 1
   - 0: –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è
   - 1: –ú–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∞—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—è
   - –û–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ–º –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏ —Å –ø–æ—Ä–æ–≥–æ–º (0.550)

## –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

```python
import joblib
import pandas as pd

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏
model_package = joblib.load('model/model.pkl')
model = model_package['model']
selected_features = model_package['selected_features']
threshold = model_package['threshold']

# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
# X_new –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å DataFrame —Å –ø—Ä–∏–∑–Ω–∞–∫–∞–º–∏ –∏–∑ selected_features
X_new = pd.DataFrame(...)  # –≤–∞—à–∏ –¥–∞–Ω–Ω—ã–µ

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
probabilities = model.predict_proba(X_new[selected_features])[:, 1]
predictions = (probabilities >= threshold).astype(int)

# –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
for i, (prob, pred) in enumerate(zip(probabilities, predictions)):
    print(f"–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è {i}: –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å={prob:.4f}, –∫–ª–∞—Å—Å={'–ú–æ—à–µ–Ω–Ω–∏—á–µ—Å–∫–∞—è' if pred == 1 else '–ù–æ—Ä–º–∞–ª—å–Ω–∞—è'}")
```

## –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è
1. –ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ –¥–∞–Ω–Ω—ã—Ö —Å –¥–∏—Å–±–∞–ª–∞–Ω—Å–æ–º –∫–ª–∞—Å—Å–æ–≤ (~78:1)
2. –ì–ª–∞–≤–Ω–∞—è –º–µ—Ç—Ä–∏–∫–∞ - F2-score (—Ñ–æ–∫—É—Å –Ω–∞ Recall - –Ω–µ –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –º–æ—à–µ–Ω–Ω–∏–∫–∞)
3. –ü–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω –¥–ª—è –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏–∏ F2-score
4. –î–ª—è –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ü–∏–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ SHAP –∑–Ω–∞—á–µ–Ω–∏—è (—Å–º. –≥—Ä–∞—Ñ–∏–∫–∏ –≤ model/)
